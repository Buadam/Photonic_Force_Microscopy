%Spherical model functions PSD, MSD and VAF
function [PSD,MSD,VAF]=psdmsdvaf_single(D,f,t,Phis,Phif,Phik,taus,tauf,tauk,ms,mf,T)

kb=1.38e-23;
PSD = 1e18*(D./(pi^2*f.^2)).*(1+sqrt(f./(2*Phif)))./((Phik./f-f./Phis-sqrt(f./(2*Phif))).^2+(1+sqrt(f./(2*Phif))).^2);
   
eq = [taus+(tauf/9) -sqrt(tauf) 1 0 1/tauk];
s = roots(eq);

MSD =  1e18*real((2*D*tauk + ((2*D)/(taus+tauf/9))*(W(1i*s(1)*sqrt(t))/(s(1)*(s(1)-s(2))*(s(1)-s(3))*(s(1)-s(4))) + ...
    W(1i*s(2)*sqrt(t))/(s(2)*(s(2)-s(1))*(s(2)-s(3))*(s(2)-s(4))) + ... 
    W(1i*s(3)*sqrt(t))/(s(3)*(s(3)-s(1))*(s(3)-s(2))*(s(3)-s(4))) + ...
    W(1i*s(4)*sqrt(t))/(s(4)*(s(4)-s(1))*(s(4)-s(2))*(s(4)-s(3))))));
    

VAF =  1e18*real((kb*T/(ms+0.5*mf))*(((s(1))^3*W(1i*s(1)*sqrt(t))/((s(1)-s(2))*(s(1)-s(3))*(s(1)-s(4))) + ...
     (s(2))^3*W(1i*s(2)*sqrt(t))/((s(2)-s(1))*(s(2)-s(3))*(s(2)-s(4))) + ...
     (s(3))^3*W(1i*s(3)*sqrt(t))/((s(3)-s(1))*(s(3)-s(2))*(s(3)-s(4))) + ...
     (s(4))^3*W(1i*s(4)*sqrt(t))/((s(4)-s(1))*(s(4)-s(2))*(s(4)-s(3))))));